<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-ietf-xml2rfc-template-05" ipr="trust200902">
  <!-- category values: std, bcp, info, exp, and historic
     ipr values: full3667, noModification3667, noDerivatives3667
     you can add the attributes updates="NNNN" and obsoletes="NNNN"
     they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only
         necessary if the full title is longer than 39 characters -->

    <title abbrev="Abbreviated Title">IPv6 home router requirements</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->
    <!-- Another author who claims to be an editor -->

    <author fullname="N" initials="N." role="editor" surname="N">
      <organization></organization>
      <address>
        <postal>
          <street></street>
          <city></city>
          <region></region>
          <code></code>
          <country></country>
        </postal>
        <phone></phone>
        <email></email>
        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <date month="October" year="2009" />

    <!-- If the month and year are both specified and are the current ones,
         xml2rfc will fill in the current day for you. If only the current
         year is specified, xml2rfc will fill in the current day and month for
         you. If the year is not the current one, it is necessary to specify
         at least a month (xml2rfc assumes day="1" if not specified for the
         purpose of calculating the expiry date).  With drafts it is normally
         sufficient to specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>General</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <!-- WG name at the upperleft corner of the doc, IETF is fine for
         individual submissions.  If this element is not present, the default
         is "Network Working Group", which is used by the RFC Editor as a nod
         to the history of the IETF. -->

    <keyword>template</keyword>

    <!-- Keywords will be incorporated into HTML output files in a meta tag
         but they have no effect on text or nroff output. If you submit your
         draft to the RFC Editor, the keywords will be used for the search
         engine. -->

    <abstract>
      <t>This document specifies requirements for an IPv6 Customer Premises
      Equipment (CPE) router. Specifically, the current version of this
      document focuses on the provisioning of an IPv6 CPE router and the
      provisioning of IPv6 hosts attached to it.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>The original specification of xml2rfc format is in <xref
      target="RFC2629">RFC2629</xref>.</t>

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <xref
        target="RFC2119">RFC 2119</xref>.</t>
      </section>
    </section>


    <section title="Terminology">
      <t><list hangIndent="8" style="hanging">
          <t hangText="HBR">Home Border Router.</t>
          <t hangText="HR">Home Router.</t>
          <t hangText="Host/Nodes">As defined in RFC2460.</t>
      </list></t>
    </section>

    <section title="Architecture">

      <section title="Review of the current IPv4 home network architecture:">

        <t>It is expected that the home network will be dual stacked and that
        the existing network topology used for IPv4 will be continued. There
        are some differences in how IPv6 works and is provisioned which has
        implications for the network architecture. The typical IPv4 home
        network consist of a "plug and play" NAT box connected to the ISP. The
        assumption is that a single NAT device with a single link behind
        it. The NAT provides stable addressing allowing for manually
        configured addresses on the nodes in the home. Existing home routers
        support dynamic routing and advanced home users can build arbitrary
        topology networks in their home. Using manual configuration of address
        prefixes combined with a dynamic routing protocol.</t>

        <t>Apart from the expert user's arbitrary network topology another
        case is the unconventional use of "plug and play" NAT devices to build
        a hierarchical multi-level NAT topology (as described in
        http://www.ietf.org/id/draft-ford-behave-top-07.txt). Multi-level NAT
        devices are provisioned and addressed automatically and as long as
        these are plugged in as a strict hierarchy it kind of works even
        though conventional network wisdom would tell you otherwise.</t>

        <t>A typical IPv4 NAT deployment gives you by default blocking of all
        incoming connections. Opening of ports is typically allowed using UPnP
        or some other firewall control protocol.</t>

        <t>Another consequence of using private address space in the home is
        that it provides stable addressing, i.e. it never changes even when
        you change ISPs, and the addresses are always there even when the
        upstream link is down or the home border router has not been
        provisioned yet.</t>

        <t>Rewriting addresses on the edge of the network also allows for some
        rudimentary multi-homing; even though using NATs for multi-homing does
        not preserve connections during fail-overs.</t>

        </section>

      <section title="IPv6 home network architecture:">

        <t>The home network architecture for IPv6 should provide equivalent or
        better capabilities and functionality than the equivalent IPv4
        architecture. The first phase architecture will not include
        zero-configuration/plug and play routers. I.e. the ability to plug in
        routers in an arbitrary network topology and have these be
        automatically provisioned.</t>

        <t>Issues which may be different in an IPv6 home network:</t>

        <t><list style="symbols">
            <t>Addresses in the home before the home border router has been
            provisioned</t>
            <t>Renumbering of address prefix in the home because use of global
            addresses</t>
            <t>Default security policy without NAT</t>
            <t>Support for coupling routers in a hierarchy, aka multi-level
            NATs</t>
        </list></t>

        <t>This architeture describes the:</t>

        <t><list style="symbols">
            <t>Basic capabilities of a home border router and home router</t>
            <t>Provisioning of upstream interface connecting to the ISP</t>
            <t>Provisioning of the downstream interfaces</t>
            <t>Automatic provisioning of a complex topology is outside of
            scope</t>
          </list></t>

        <t>The home network is a stub network. Arbitrary topology is possible,
        but is out of scope for this work. Automatic provisioning and
        configuration is described for a restricted hierarchy only.</t>

      <figure align="center" anchor="sp_architecture">
        <preamble>An example of a typical home network.</preamble>

        <artwork align="left"><![CDATA[

                  +-------+-------+                   \
                  |   Service     |                    \
                  |   Provider    |                     | ISP
                  |    Router     |                     | network
                  +-------+-------+                     |
                          |                             /
                          | Customer                   /
                          | Internet connection       /
                          |
                   +------+------+                    \
                   |     IPv6    |                     \
                   | Home Border |                      \
                   |    Router   |                      /
                   +---+-------+-+                     /
       Network A       |       |   Network B          | Customer
 ---+-------------+----+-    --+--+-------------+---  |network(s)
    |             |               |             |      \
+----+-----+ +-----+----+     +----+-----+ +-----+----+  \
|IPv6 Host | |IPv6 Host |     | IPv6 Host| |IPv6 Host |  /
|          | |          |     |          | |          | /
+----------+ +-----+----+     +----------+ +----------+/

            ]]></artwork>

        <postamble></postamble>
      </figure>

      <figure align="center" anchor="multilevel_architecture">
        <preamble>An example of two home routers coupled in serial, an IPv4
        multi-level NAT topology.</preamble>

        <artwork align="left"><![CDATA[

                  +-------+-------+                   \
                  |   Service     |                    \
                  |   Provider    |                     | ISP
                  |    Router     |                     | network
                  +-------+-------+                     |
                          |                             /
                          | Customer                   /
                          | Internet connection       /
                          |
                   +------+------+                    \
                   |     IPv6    |                     \
                   | Home Border |                      \  Customer
                   |    Router   |                      /  Network(s)
                   +---+-------+-+                     /
                          |
                          |
                   +------+------+                    \
                   |     IPv6    |                     \
                   | Home Router |                      \
                   |             |                      /
                   +---+-------+-+                     /
       Network A       |       |   Network B          |
 ---+-------------+----+-    --+--+-------------+---  |
    |             |               |             |      \
+----+-----+ +-----+----+     +----+-----+ +-----+----+  \
|IPv6 Host | |IPv6 Host |     | IPv6 Host| |IPv6 Host |  /
|          | |          |     |          | |          | /
+----------+ +-----+----+     +----------+ +----------+/

            ]]></artwork>

        <postamble></postamble>
      </figure>


        <t>What about the case where the HBR is supplied by the SP and the
        home network admin wants to add a serially-connected router under
        complete home network admin control?  We've heard that this use case
        must be supported; how do we judge the priority for supporting that
        use case?</t>

        <t>For the purposes of provisioning the HBR upstream interface acts as
        a host. It MAY acquire an IPv6 address or addresses using DHCP or
        SLAAC. Other configuration information is acquired using DHCP as
        described in RFC3315. The HBR is a requesting router for the purposes
        of prefix delegation and MUST always initiate prefix delegation
        according to RFC3633. TBD: Mechanism for choosing next-hop for
        default.</t>

        <t>The HBR assigns a /64 from its delegated prefix to each of its
        downstream LAN interfaces. It SHOULD by default also assign a Unique
        Local Address (ULA) to its LAN interfaces for communciation within the
        home network.</t>

        <t>Home hosts acquire IPv6 addresses either through SLAAC or DHCP. The
        HBR provides configuration information obtained from provisioning of
        the upstream interface to the hosts on the downstream interface(s)
        using DHCP.  TBD: Describe that HR or HBR must be able to detect
        upstream and downstream interfaces. That for the purpose of
        hierarchical PD it should be a DHCP relay downstream).</t>

        <t>I'm not sure if this paragraph is architecture or deployment
        choice.</t>

        <t>The HBR acting as the demarcation point between two networks
        implements a ULA boundary, multicast zone boundary as well as ingress
        and egress traffic filters.</t>

        <t>An HBR or HR is acting as an IPv6 router for unicast traffic and
        may be configured in an arbitrary topology with a dynamic routing
        protocol. For IPv6 multicast traffic the HBR or HR by default act as
        an MLD proxy but may support a dynamic multicast routing protocol.</t>

        <t>The HBR or HR does not support a local DNS proxy or DNS server and
        must pass DNS traffic through transparently like any other
        traffic.</t>

        <t>IPv6 and/or IPv4 DNS traffic?</t>

      </section>
    </section>

    <section title="Use Cases and Requirements">
      <section title="Provisioning the WAN side">
        <t>IPv6 Neighbour Discovery and DHCPv6 operates over any type of IPv6
        link and there is therefore no need for a link-layer specific
        configuration protocol for IPv6 network layer configuration options
        like what's in PPP IPCP for IPv4. This section makes the assumption
        that the same mechanism will work for any link layer, be it Ethernet,
        DOCSIS or PPP/PPPoE.</t>

        <t>When the router is attached to the upstream link it must act as an
        IPv6 host for the purposes of IPv6 interface initialisation, ND router
        discovery, prefix discovery and acquiring addresses on the interface
        (RFC4861/RFC4862. The router acts as a requesting router for the
        purposes of DHCP prefix delegation (RFC3633).</t>

        <texttable anchor="upstream_requirements" title="Upstream requirements">
          <preamble></preamble>
          <ttcol align="left">Requirement</ttcol>
          <ttcol align="left">Description</ttcol>
          <c>W-1</c>
          <c>The Home Router MUST support SLAAC (RFC 4862)</c>
          <c>W-2</c>
          <c>The Home Router MUST support DHCPv6 (RFC 3315) stateful client
          behavior. It MUST be able to support IA_NA, Reconfigure Accept, and
          IA_PD (RFC 3633) options.</c>
          <c>W-3</c>
          <c>If the Home Router does not acquire a GUA IPv6 address from
          either SLAAC or DHCPv6, then it MUST create a GUA IPv6 address from
          the delegated prefix (IA_PD) it receives.</c>
          <c>W-4</c>
          <c>The Home Router MUST either honor the M and O flags in received
          RA messages, or always perform stateful DHCPv6 and request
          IA_NA.</c>
          <c>W-5</c>
          <c>The Home Router MUST support receiving DNS information from
          DHCPv6 DNS_SERVERS (23) option (RFC 3646).</c>
          <c>W-6</c>
          <c>If the Home Router has no DNS information when it sends its
          DHCPv6 Solicit message, it MUST by default request DNS_SERVERS at
          that time.</c>
          <c>W-7</c>
          <c>The Home Router SHOULD support acquiring SNTP information by
          DHCPv6 (RFC 4075).</c>
          <c>W-8</c>
          <c>To facilitate DHCP reconfiguration in response to changes in the
          Service Provider network, the Home Router SHOULD support the
          Reconfigure Key Authentication Protocol, as described in (RFC
          3315).</c>

          <postamble></postamble>
        </texttable>

      </section>
      <section title="Provisioning the LAN side">

        <t>The Home Router distributes configuration information obtained
        during WAN interface provisioning to IPv6 Home Devices and assists
        IPv6 Home Devices in obtaining IPv6 GUAs. It also supports
        connectivity of these devices in the absence of any working WAN
        interface.</t>

        <t>A Home Router will be expected to support an IPv6 Home Network and
        IPv6 Home Devices that exhibit the following characteristics:</t>

        <t><list style="numbers">
            <t>Link Layer addresses are insufficient for allowing IPv6
            applications to communicate with each other on the home
            network. The Home Router will need to enable this communication by
            providing the means for globally-scoped unicast addresses to be
            used, whether or not WAN connectivity exists.</t>

            <t>The IPv6 Home Devices will support SLAAC for acquiring their
            addresses. They might support DHCPv6 for address acquisition
            (IA_NA), but this support cannot be assumed by the Home
            Router.</t>

            <t>The IPv6 Home Devices will support stateless DHCPv6
            configuration. Specifically, they will support the DNS_SERVERS
            option for acquiring DNS information. They may support other
            configuration methods (such as the RDNSS option in RA), but this
            cannot be assumed.</t>

            <t>Consumers commonly place other Home Routers behind the border
            Home Router that provides the IP connection to the service
            provider access network.</t>
        </list></t>

        <texttable anchor="downstream_requirements" title="Downstream requirements">
          <preamble></preamble>
          <ttcol align="left">Requirement</ttcol>
          <ttcol align="left">Description</ttcol>
          <c>L-1</c>
          <c>The Home Router MUST support ULA addressing (RFC 4193).</c>
          <c>L-2</c>
          <c>The Home Router MUST have a ULA prefix that it maintains
          consistently across reboots.</c>
          <c>L-3</c>
          <c>It SHOULD be possible for the user to configure the value of this
          ULA prefix.</c>
          <c>L-4</c>
          <c>The Home Router MUST support router behavior of Neighbor Discover
          for IPv6 (RFC 4861).</c>
          <c>L-5</c>
          <c>If the Home Router is configured to provide ULA addressing to
          IPv6 Home Devices, it MUST provide a /64 prefix from its ULA prefix
          in its RA message, with A and L bits set to 1.</c>
          <c>L-6</c>
          <c>The Home Router MUST provide an /64 prefix from its received
          IA_PD in its RA message. This prefix MUST have A bit set to 1 and L
          bit set to 1.</c>
          <c>L-7</c>
          <c>If the Home Router has multiple LAN interfaces, and its received
          IA_PD is shorter than a /64, it SHOULD use (in its RA message) a
          unique /64 for each LAN interface, to the extent possible.</c>
          <c>L-8</c>
          <c>The Home Router MUST support stateful DHCPv6 server behavior (RFC
          3315) for delegated prefix (IA_PD) assignment (RFC 3633). This is to
          support another Home Router behind it. No algorithm for selection of
          a prefix to delegate is provided at this time. The Home Router can
          have a proprietary delegation mechanism and/or allow the user to
          configure the delegation.</c>
          <c>L-9</c>
          <c>The Home Router MUST support stateless DHCPv6 server behavior
          (RFC 3736).</c>
          <c>L-10</c>
          <c>The Home Router SHOULD support DHCPv6 IA_NA option.</c>
          <c>L-11</c>
          <c>Unless the Home Router is configured to support DHCPv6 IA_NA, it
          SHOULD set M=0 and O=1 in its RA messages.</c>
          <c>L-12</c>
          <c>The Home Router MUST support providing DNS information in the
          DHCPv6 DNS_SERVERS option (RFC 3646).</c>
          <c>L-13</c>
          <c>If the Home Router provides its own IP address to IPv6 Home
          Devices as the DNS server for those home devices, it MUST implement
          a DNS Proxy as defined in RFC 5625.</c>
          <c>L-14</c>
          <c>The Home Router SHOULD pass the additional set of DHCPv6 options
          received from the DHCP client on its WAN interface from the Service
          Provider to IPv6 Home Devices.</c>
          <c>L-15</c>
          <c>If the Home Router supports RDNSS (RFC 5006), it MUST still set
          O=1 in the RA message and provide DNS server information by DHCPv6,
          when that option is requested.</c>


          <postamble></postamble>
        </texttable>
      </section>

      <section title="Multi-level router considerations">
      </section>

      <section title="Transition mechanism support">
      </section>
      <section title="Other capabilites">
        <t>TODO: DNS, Multicast routing, dynamic routing, Managebility,
        UPnP</t>
      </section>
      <section title="Security">
        <t>It is considered a best practice to filter obviously malicious
        traffic (e.g. spoofed packets, "martian" addresses, etc.).  Thus, the
        IPv6 CPE Router should support basic stateless egress and ingress
        filters.  The CPE router should also offer mechanisms to filter
        traffic entering the customer network; however, the method by which
        vendors implement configurable packet filtering is beyond the scope of
        this document.</t>

        <texttable anchor="security_requirements" title="Security requirements">
          <preamble></preamble>
          <ttcol align="left">Requirement</ttcol>
          <ttcol align="left">Description</ttcol>
          <c>S-1</c>
          <c>The CPE Router SHOULD support
          [I-D.ietf-v6ops-cpe-simple-security].</c>
          <c>S-2</c>
          <c>The CPE Router MUST support ingress filtering in accordance
          with</c>
          <postamble></postamble>
        </texttable>

      </section>
    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t></t>
    </section>

    <!-- Possibly a 'Contributors' section ... -->

    <section anchor="IANA" title="IANA Considerations">
      <t>This memo includes no request to IANA.</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>All drafts are required to have a security considerations section.
      See <xref target="RFC3552">RFC 3552</xref> for a guide.</t>
    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation
     libraries: 1. define an ENTITY at the top, and use "ampersand
     character"RFC2629; here (as shown) 2. simply use a PI "less than
     character"?rfc include="reference.RFC.2119.xml"?> here (for I-Ds:
     include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.  If
     you use the PI option, xml2rfc will, by default, try to find included
     files in the same directory as the including file. You can also define
     the XML_LIBRARY environment variable with a value containing a set of
     directories to search.  These can be either in the local filing system or
     remote ones accessed by http (http://domain/dir/... ).-->

    <references title="Normative References">
      <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->
      &RFC2119;

      <reference anchor="min_ref">
        <!-- the following is the minimum to make xml2rfc happy -->

        <front>
          <title>Minimal Reference</title>

          <author initials="authInitials" surname="authSurName">
            <organization></organization>
          </author>

          <date year="2006" />
        </front>
      </reference>
    </references>

    <references title="Informative References">
      <!-- Here we use entities that we defined at the beginning. -->

      &RFC2629;

      &RFC3552;

      &I-D.narten-iana-considerations-rfc2434bis;

      <!-- A reference written by by an organization not a person. -->

      <reference anchor="DOMINATION"
                 target="http://www.example.com/dominator.html">
        <front>
          <title>Ultimate Plan for Taking Over the World</title>

          <author>
            <organization>Mad Dominators, Inc.</organization>
          </author>

          <date year="1984" />
        </front>
      </reference>
    </references>

    <section anchor="app-additional" title="Additional Stuff">
      <t>This becomes an Appendix.</t>
    </section>

    <!-- Change Log

v00 2006-03-15  EBD   Initial version

      -->
  </back>
</rfc>
